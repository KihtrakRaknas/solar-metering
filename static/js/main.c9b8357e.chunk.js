(this["webpackJsonpsolar-metering"]=this["webpackJsonpsolar-metering"]||[]).push([[0],{130:function(e,t,a){"use strict";a.r(t);var n=a(5),c=a(2),r=a.n(c),i=a(35),s=a.n(i),l=(a(80),a(81),a(82),a(83),a(60)),o=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,134)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};s.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(l.a,{})}),document.getElementById("root")),o()},26:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(5),c=(a(2),a(67)),r=a.n(c);function i(){return Object(n.jsx)(r.a,{type:"bars",color:"black",height:667,width:375})}},34:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(39),c=a(5),r=(a(2),a(15)),i=a(40);function s(e){var t=Object(i.a)(e.data,e.fields),a=t.key,s=t.tableData;return console.log(e.reverse),Object(c.jsx)(r.c,{striped:!0,borderless:!0,small:!0,hover:!0,sortable:!1,data:{columns:a,rows:e.reverse?s:Object(n.a)(s).reverse()}})}},40:function(e,t,a){"use strict";function n(e,t){return e.forEach((function(e){var t="time (UTC)";e[t]=new Date(e[t]).toUTCString()})),{tableData:e,key:Object.keys(e[0]).filter((function(e){return!t||t.includes(e)})).map((function(e){return{label:e.split("_").join(" ").replace("Vb max daily","Battery Voltage Max (Daily)").replace("Vb min daily","Battery Voltage Min (Daily)").replace("Whc daily","Battery Wh (Daily)").replace("fault daily","Fault Daily").replace("alarm daily","Alarm Daily"),field:e}}))}}a.d(t,"a",(function(){return n}))},60:function(e,t,a){"use strict";(function(e){var n=a(19),c=a(5),r=a(2),i=a(74),s=a(70),l=a(71),o=a(73),d=a(31),j=a(10),u=a(38);a(129);try{u.a.initializeApp({apiKey:"AIzaSyD2K0qINs7uoG6-2whLT8Wgab_AvAhVEzI",authDomain:"sierra-leone-cec24.firebaseapp.com",projectId:"sierra-leone-cec24",storageBucket:"sierra-leone-cec24.appspot.com",messagingSenderId:"458713135578",appId:"1:458713135578:web:d5a3e153fa883269ace8e3"})}catch(h){}var b=u.a.firestore();t.a=function(){var t=Object(r.useState)([]),a=Object(n.a)(t,2),u=a[0],h=a[1],f=Object(r.useState)(-1),O=Object(n.a)(f,2),x=O[0],p=O[1],m=Object(r.useState)((new Date).getUTCFullYear()),g=Object(n.a)(m,2),y=g[0],v=g[1],w=function(){console.log("fetching!"),fetch("http://localhost:4001/logfile").then((function(e){return e.json()})).then((function(t){console.log(t),h(t),e.firebaseListener&&(e.firebaseListener(),e.firebaseListener=null)})).catch((function(t){if(null==e.firebaseListener){var a=b.collection("logData").doc(""+y);e.firebaseListener=a.onSnapshot((function(e){h(e.data().data),console.log(e.data().timestamp.seconds),p(1e3*e.data().timestamp.seconds)}))}console.log(t)}))};return Object(r.useEffect)((function(){w(),setInterval(w,3e4)}),[!0]),Object(c.jsxs)(d.a,{children:[Object(c.jsx)(o.a,{firebaseTimestamp:x,year:y}),Object(c.jsxs)(j.c,{children:[Object(c.jsx)(j.a,{path:"/full-table",children:Object(c.jsx)(s.a,{data:u})}),Object(c.jsx)(j.a,{path:"/historical-data",children:Object(c.jsx)(l.a,{year:y,setYear:v})}),Object(c.jsx)(j.a,{path:"/",children:Object(c.jsx)(i.a,{data:u})})]})]})}}).call(this,a(23))},70:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(19),c=a(5),r=a(2),i=a(34),s=a(26),l=a(15);function o(e){var t=e.data,a=Object(r.useState)(!1),o=Object(n.a)(a,2),d=o[0],j=o[1];return Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)("br",{}),Object(c.jsx)("div",{className:"title_component",children:Object(c.jsx)("header",{className:"App-header",children:Object(c.jsx)("h1",{className:"App-title",style:{textAlign:"center"},children:"Complete Solar Data from MSView"})})}),Object(c.jsx)("br",{}),Object(c.jsxs)("div",{style:{padding:15,overflowX:"auto"},children:[t.length>0?Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(i.a,{data:t,reverse:d})}):Object(c.jsx)(s.a,{}),Object(c.jsx)("div",{style:{textAlign:"center"},children:Object(c.jsx)(l.b,{gradient:d?"peach":"purple",onClick:function(){return j(!d)},children:"Reverse Order"})})]})]})}},71:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(48),c=a.n(n),r=a(41),i=a(49),s=a(72),l=a(39),o=a(19),d=a(5),j=a(2),u=(a(34),a(26)),b=a(15),h=a(38);function f(e){var t=e.year,a=e.setYear,n=Object(j.useState)([]),f=Object(o.a)(n,2),O=f[0],x=f[1],p=Object(j.useState)({}),m=Object(o.a)(p,2),g=m[0],y=m[1];return Object(j.useEffect)((function(){var e=h.a.firestore(),t=[];e.collection("logData").get().then((function(e){e.forEach((function(e){t.push(e)}))})),x(t)}),[!0]),Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)("br",{}),Object(d.jsx)("div",{className:"title_component",children:Object(d.jsx)("header",{className:"App-header",children:Object(d.jsx)("h1",{className:"App-title",style:{textAlign:"center"},children:"Historical Data"})})}),Object(d.jsx)("br",{}),Object(d.jsxs)("div",{style:{padding:15,overflowX:"auto"},children:[Object(d.jsxs)("h2",{children:["Currently loaded data for ",t]}),Object(d.jsxs)("p",{children:["The site will be populated with data from ",t,"."]}),O.length>0?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)(b.d,{children:[Object(d.jsx)(b.g,{caret:!0,color:"primary",children:"Load year"}),Object(d.jsx)(b.f,{basic:!0,children:Object(l.a)(O).map((function(e){return Object(d.jsx)(b.e,{onClick:function(){return a(e.id)},children:e.id})}))})]}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)("br",{}),Object(d.jsx)("h2",{children:"Download links:"}),Object(l.a)(O).map((function(e){return null==g[e.id]&&Object(s.a)(c.a.mark((function t(){var a,n,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.data(),n=new Blob([JSON.stringify(a)],{type:"application/json"}),s=URL.createObjectURL(n),console.log(s),y(Object(i.a)(Object(i.a)({},g),{},Object(r.a)({},e.id,s)));case 5:case"end":return t.stop()}}),t)})))(),Object(d.jsx)(b.b,{disabled:null==g[e.id],download:e.id+".json",href:g[e.id],children:null==g[e.id]?"loading...":e.id})}))]}):Object(d.jsx)(u.a,{})]})]})}},73:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(19),c=a(5),r=a(2),i=a(15);function s(e){var t=e.firebaseTimestamp,a=e.year,s=Object(r.useState)(null),l=Object(n.a)(s,2),o=l[0],d=l[1],j=function(){fetch("http://localhost:4001/last-write").then((function(e){return e.json()})).then((function(e){console.log("Last Write: ".concat(e.lastWrite)),d(e.lastWrite)})).catch((function(e){console.log(e)}))};Object(r.useEffect)((function(){j(),setInterval(j,3e4)}),[!0]);var u=function(e){var t=(new Date-e)/36e5;return{hours:Math.floor(t%24),days:Math.floor(t/24),recent:t<1,hoursFixed:(t%24).toFixed(2)}}(-1!=o&&null!=o?o:t);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("nav",{children:Object(c.jsxs)(i.k,{color:"gray",expand:"md",fixed:"top",scrolling:!0,style:{backgroundColor:"white"},children:[Object(c.jsx)(i.l,{children:Object(c.jsx)("strong",{className:"black-text",children:"Solar Metering"})}),Object(c.jsx)(i.j,{to:"/home",children:"Graphs"}),Object(c.jsx)(i.j,{to:"/full-table",children:"Full Table"}),-1!=t&&Object(c.jsxs)(i.j,{to:"/historical-data",children:["Historical Data ",(new Date).getUTCFullYear()!=a?"(".concat(a,")"):""]}),Object(c.jsx)("div",{className:"ml-auto",children:null!=o?-1==o?"No uploads have happened yet":u.recent?"An upload recently took place":"Last upload was ".concat(u.hours," hours and ").concat(u.days," days ago"):-1!=t?"Logs are from ".concat(u.hoursFixed," hours and ").concat(u.days," days ago"):""})]})}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{})]})}},74:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(5),c=a(34),r=a(26),i=a(19),s=a(68),l=a(2),o=a(40),d=a(69),j=a.n(d);function u(e){var t,a=Object(o.a)(e.data).tableData,c=function(){var e=Object(l.useState)({width:void 0,height:void 0}),t=Object(i.a)(e,2),a=t[0],n=t[1];return Object(l.useEffect)((function(){function e(){n({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),a}(),r=[],d=Object(s.a)(e.categories);try{for(d.s();!(t=d.n()).done;){var u=t.value,h=b(u,a),f=h.x,O=h.y;r.push({x:f,y:O,name:u,type:"scatter",mode:"lines+markers",marker:{color:u.includes("max")?"red":"black"}})}}catch(x){d.e(x)}finally{d.f()}return Object(n.jsx)(j.a,{data:r,layout:{width:c.width-20,height:500,title:e.title,xaxis:{title:"Time"},yaxis:{title:e.yTitle}},config:{responsive:!0}})}function b(e,t){return{x:t.map((function(e){return new Date(e["time (UTC)"])})),y:t.map((function(t){return Number(t[e.split(" ").join("_")])}))}}function h(e){var t=e.data;return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)("br",{}),Object(n.jsx)("div",{className:"title_component",children:Object(n.jsx)("header",{className:"App-header",children:Object(n.jsx)("h1",{className:"App-title",style:{textAlign:"center"},children:"Real-Time Solar Output"})})}),t.length>0?Object(n.jsx)(u,{data:t,categories:["Vb min daily","Vb max daily"],title:"Vb Over Time",yTitle:"Vb Value (unit goes here)"}):Object(n.jsx)(r.a,{}),t.length>0?Object(n.jsx)(u,{data:t,categories:["Whc daily"],title:"Whc Value",yTitle:"Whc Value (unit goes here)"}):Object(n.jsx)(r.a,{}),Object(n.jsx)("div",{style:{padding:15,overflowX:"auto"},children:t.length>0?Object(n.jsx)(n.Fragment,{children:Object(n.jsx)(c.a,{data:t,fields:["time (UTC)","Vb_max_daily","Vb_min_daily","Whc_daily","alarm_daily"]})}):Object(n.jsx)(r.a,{})})]})}},80:function(e,t,a){}},[[130,1,2]]]);
//# sourceMappingURL=main.c9b8357e.chunk.js.map